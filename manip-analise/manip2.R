## Bibliotecas necessárias
library(dplyr)
library(tidyr)
library(data.table)

## Importando o df da rais(2020), 156 obs
df.2020 <- read.csv("C:/Users/Lucas/Desktop/consulta 155.xlsx - 2020.csv", header=TRUE)

## Importando o df de patentes, 1662 obs
patentePI <- read.csv("C:/Users/Lucas/Desktop/5a - Dep???sitos de Patentes do Tipo PI por Cidade.csv", header=TRUE)

## Limpando a tabela da rais. Separando a id do nome do município
edit <- df.2020 %>%
  separate(col = municipio, into = c('ID', 'local'), sep = ':') %>%
  separate(col = local, into = c('uf', 'municipio'), sep = '-') %>%
  select(-2) %>%
  filter(row_number() <= n()-1) %>%
  arrange(ID)

## Pegando apenas as cidades que interessam do df de patentes
v2 <- patentePI %>%
  filter(ID %in% c("1100205","1200401","1302603","1400100","1500800",
                   "1501402","1502400",",1504208","1505536","1506807",
                   "1600303" ,"1721000" ,"2105302", "2111300" ,"2211001",
                   "2303709" ,"2304400" ,"2307304" ,"2307650" ,"2312908",
                   "2403251", "2408003" ,"2408102" ,"2504009" ,"2507507",
                   "2602902" ,"2604106", "2607901", "2609600", "2610707",
                   "2611101", "2611606" ,"2700300" ,"2704302" ,"2800308",
                   "2905701" ,"2910800" ,"2914802" ,"2918407" ,"2927408",
                   "2933307" ,"3106200" ,"3106705" ,"3118601" ,"3122306",
                   "3127701" ,"3131307" ,"3136702" ,"3143302" ,"3154606",
                   "3157807" ,"3167202" ,"3170107" ,"3170206" ,"3201209",
                   "3201308" ,"3205002" ,"3205200" ,"3205309" ,"3300100",
                   "3300456" ,"3300704" ,"3301009" ,"3301702" ,"3301900",
                   "3302403" ,"3302502" ,"3303302" ,"3303500" ,"3303906",
                   "3304557" ,"3304904" ,"3305109" ,"3306305" ,"3501608",
                   "3503208" ,"3505708" ,"3506003" ,"3509502" ,"3510609",
                   "3513009" ,"3513801" ,"3515004" ,"3516200" ,"3518701",
                   "3518800" ,"3519071" ,"3520509" ,"3522505" ,"3523107",
                   "3524402" ,"3525904" ,"3526902" ,"3529005" ,"3529401",
                   "3530607" ,"3534401" ,"3538709" ,"3541000" ,"3541406",
                   "3543402" ,"3543907" ,"3547809" ,"3548500" ,"3548708",
                   "3548906" ,"3549805" ,"3549904" ,"3550308" ,"3551009",
                   "3552205" ,"3552403" ,"3552502" ,"3552809" ,"3554102",
                   "4104808" ,"4105805" ,"4106902" ,"4108304" ,"4113700",
                   "4115200" ,"4119905" ,"4125506" ,"4202404" ,"4204202",
                   "4204608" ,"4205407" ,"4208203" ,"4209102" ,"4216602",
                   "4300604" ,"4304606" ,"4305108" ,"4309209" ,"4313409",
                   "4314100" ,"4314407" ,"4314902" ,"4315602" ,"4316907",
                   "4318705" ,"4323002" ,"5002704" ,"5003702", "5103403",
                   "5107602", "5108402", "5200258" ,"5201108" ,"5201405",
                   "5208707" ,"5212501", "5218805" ,"5300108")) %>%
  arrange(ID)

## Função que exporta um objeto do tipo dataframe em csv
fwrite(v2,"C:/Users/Lucas/Desktop/v2.csv")
